// KV-Keeper.js by andre487, see https://clck.ru/9cB92
!function(e,n){"use strict";function t(){a.dbVersion=1,a.dbName="kv-keeper-items",a.storeName="items",a.defaultType=d,a.namespace=r()}function r(){return a.dbName+":"+a.storeName+":"}function o(e){if([m,p,d].indexOf(e)==-1)throw new Error(g+"Invalid type "+e)}function i(e){return function(n,t){if(n)for(var r=0;r<h.length;r++)h[r](n);return e(n,t)}}function u(e){switch(e){case d:return f();case p:return c(p,DB.create());case m:return c(m,I.create())}return null}function c(e,n){return{type:e,instance:n}}function f(){var e=y.db;return e?c(p,e):(e="undefined"!=typeof DB&&DB.create())?c(p,e):(e=y.ls,e?c(m,e):"undefined"!=typeof I?c(p,I.create()):void 0)}var a,s=["setItem","getItem","removeItem","getKeys","getLength","clear"],l=["dbName","storeName","defaultType"],p="db",m="ls",d="auto",g="[kv-keeper] ",v=Object.keys,y={},h=[];n?a=n:e.KvKeeper=a={},t(),a.addErrorListener=function(e){if("function"!=typeof e)throw new Error("Listener must be a function");h.push(e)},a.removeErrorListener=function(e){var n=h.indexOf(e);n>-1&&h.splice(n,1)},a.getErrorListeners=function(){return h},a.removeAllErrorListeners=function(){h=[]},a.configure=function(e){if(a.__configured)throw new Error(g+"Configuration can be set only once");a.__configured=!0,"defaultType"in e&&o(e.defaultType),v(e).forEach(function(n){if(!(l.indexOf(n)>-1))throw t(),new Error(g+n+" is not configurable");a[n]=e[n]}),a.namespace=r()},a.getStorage=function(e,n){"function"==typeof e&&(n=e,e=null),n=i(n),e=e||a.defaultType,o(e);var t=a._getInstance(e);if(t)t.init(n);else{var r=e==d?"No supported stores":'No "'+e+'" store support';n(new Error(g+r))}},a._getInstance=function(e){var n=y[e];if(!n){var t=u(e);n=y[t.type]=t.instance}return n},s.forEach(function(e){a[e]=function(){var n=arguments;a.getStorage(function(t,r){if(t){var o=n[n.length-1];return o(t)}r[e].apply(r,n)})}});var I=a.StorageLS=function(e){var n=this;n.init=function(e){e(null,n)},n.setItem=function(n,t,r){r=i(r);try{e.setItem(I.createKey(n),t),r(null)}catch(e){r(e)}},n.getItem=function(n,t){t(null,e.getItem(I.createKey(n)))},n.removeItem=function(n,t){e.removeItem(I.createKey(n)),t(null)},n.getKeys=function(n){for(var t=v(e),r=a.namespace.length,o=[],i=0;i<t.length;i++){var u=t[i];E(u)&&o.push(u.slice(r))}n(null,o)},n.getLength=function(n){n(null,v(e).filter(E).length)},n.clear=function(n){v(e).filter(E).forEach(e.removeItem,e),n(null)},n.close=function(){y.ls=null}};I.createKey=function(e){return a.namespace+e};var E=I.isKeeperKey=function(e){return 0==e.indexOf(a.namespace)};I.create=function(){var n=e.localStorage;return n?new I(n):null}}(self,"undefined"!=typeof exports&&exports);
//# sourceMappingURL=kv-keeper.ls.map