// KV-Keeper.js by andre487, see https://clck.ru/9cB92
!function(p,v){"use strict";function m(){e.dbVersion=1,e.dbName="kv-keeper-items",e.storeName="items",e.defaultType=a,e.namespace=g()}function g(){return e.dbName+":"+e.storeName+":"}function d(e){if(-1==[c,o,a].indexOf(e))throw new Error(f+"Invalid type "+e)}function l(e){return function(n,o){if(n)for(var r=0;r<t.length;r++)t[r](n);return e(n,o)}}function E(e){switch(e){case a:return h();case o:return r(o,DB.create());case c:return r(c,n.create())}return null}function r(e,n){return{type:e,instance:n}}function h(){var e=u.db;return e?r(o,e):(e="undefined"!=typeof DB&&DB.create())?r(o,e):(e=u.ls,e?r(c,e):"undefined"!=typeof n?r(o,n.create()):void 0)}var e,I=["setItem","getItem","removeItem","getKeys","getLength","clear"],y=["dbName","storeName","defaultType"],o="db",c="ls",a="auto",f="[kv-keeper] ",i=Object.keys,u={},t=[];v?e=v:p.KvKeeper=e={},m(),e.addErrorListener=function(e){if("function"!=typeof e)throw new Error("Listener must be a function");t.push(e)},e.removeErrorListener=function(n){var e=t.indexOf(n);e>-1&&t.splice(e,1)},e.getErrorListeners=function(){return t},e.removeAllErrorListeners=function(){t=[]},e.configure=function(n){if(e.__configured)throw new Error(f+"Configuration can be set only once");e.__configured=!0,"defaultType"in n&&d(n.defaultType),i(n).forEach(function(t){if(!(y.indexOf(t)>-1))throw m(),new Error(f+t+" is not configurable");e[t]=n[t]}),e.namespace=g()},e.getStorage=function(n,t){"function"==typeof n&&(t=n,n=null),t=l(t),n=n||e.defaultType,d(n);var r=e._getInstance(n);if(r)r.init(t);else{var o=n==a?"No supported stores":'No "'+n+'" store support';t(new Error(f+o))}},e._getInstance=function(n){var e=u[n];if(!e){var t=E(n);e=u[t.type]=t.instance}return e},I.forEach(function(n){e[n]=function(){var t=arguments;e.getStorage(function(e,r){if(e){var o=t[t.length-1];return o(e)}r[n].apply(r,t)})}});var n=e.StorageLS=function(r){var t=this;t.init=function(e){e(null,t)},t.setItem=function(t,o,e){e=l(e);try{r.setItem(n.createKey(t),o),e(null)}catch(n){e(n)}},t.getItem=function(e,t){t(null,r.getItem(n.createKey(e)))},t.removeItem=function(e,t){r.removeItem(n.createKey(e)),t(null)},t.getKeys=function(c){for(var t=i(r),a=new RegExp("^"+e.namespace),o=[],n=0;n<t.length;n++){var u=t[n];s(u)&&o.push(u.replace(a,""))}c(null,o)},t.getLength=function(e){e(null,i(r).filter(s).length)},t.clear=function(e){i(r).filter(s).forEach(r.removeItem,r),e(null)},t.close=function(){u.ls=null}};n.createKey=function(n){return e.namespace+n};var s=n.isKeeperKey=function(n){return 0==n.indexOf(e.namespace)};n.create=function(){var e=p.localStorage;return e?new n(e):null}}(self,"undefined"!=typeof exports&&exports);
//# sourceMappingURL=kv-keeper.ls.map