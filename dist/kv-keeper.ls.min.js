// KV-Keeper.js by andre487, see https://clck.ru/9cB92
!function(e,n){"use strict";function t(){}function r(){l.dbVersion=1,l.dbName="kv-keeper-items",l.storeName="items",l.defaultType=v,l.namespace=o()}function o(){return l.dbName+":"+l.storeName+":"}function u(e){if([m,g,v].indexOf(e)==-1)throw new Error(d+"Invalid type "+e)}function i(e){var n=e||t;return function(e,t){if(e)for(var r=0;r<I.length;r++)I[r](e);return n(e,t)}}function a(e){switch(e){case v:return f();case g:return c(g,DB.create());case m:return c(m,w.create())}return null}function c(e,n){return{type:e,instance:n}}function f(){var e=h.db;return e?c(g,e):(e="undefined"!=typeof DB&&DB.create())?c(g,e):(e=h.ls,e?c(m,e):"undefined"!=typeof w?c(m,w.create()):void 0)}var l,s=["setItem","getItem","hasItem","removeItem","getKeys","getLength","clear"],p=["dbName","storeName","defaultType"],g="db",m="ls",v="auto",d="[kv-keeper] ",y=Object.keys,h={},I=[];n?l=n:e.KvKeeper=l={},r(),l.preconnect=function(){l.getStorage(t)},l.addErrorListener=function(e){if("function"!=typeof e)throw new Error("Listener must be a function");I.push(e)},l.removeErrorListener=function(e){var n=I.indexOf(e);n>-1&&I.splice(n,1)},l.getErrorListeners=function(){return I},l.removeAllErrorListeners=function(){I=[]},l.configure=function(e){if(l.__configured)throw new Error(d+"Configuration can be set only once");l.__configured=!0,"defaultType"in e&&u(e.defaultType);for(var n in e)if(e.hasOwnProperty(n)){if(!(p.indexOf(n)>-1))throw r(),new Error(d+n+" is not configurable");l[n]=e[n]}l.namespace=o()},l.getStorage=function(e,n){var t=e,r=n;"function"==typeof t&&(r=e,t=null),r=i(r),t=t||l.defaultType,u(t),l._getInstance(t,r)},l._getInstance=function(e,n){var t=h[e];if(t)return n(null,t);var r=d+(e==v?"No supported storages":'No "'+e+'" storage support');if(null===t)return n(new Error(r));var o=a(e);return o&&o.instance?(t=h[e]=o.instance,void t.init(n)):n(new Error(r))},s.forEach(function(e){l[e]=function(){for(var n=[],t=0;t<arguments.length;t++)n.push(arguments[t]);l.getStorage(function(t,r){if(t){var o=n[n.length-1];return o(t)}r[e].apply(r,n)})}});var w=l.StorageLS=function(e){var n=this;n.init=function(e){e(null,n)},n.setItem=function(n,t,r){var o=i(r);try{e.setItem(w.createKey(n),t),o(null)}catch(e){o(e)}},n.getItem=function(n,t){t(null,e.getItem(w.createKey(n)))},n.hasItem=function(n,t){t(null,null!==e.getItem(w.createKey(n)))},n.removeItem=function(n,r){var o=r||t;e.removeItem(w.createKey(n)),o(null)},n.getKeys=function(n){for(var t=y(e),r=l.namespace.length,o=[],u=0;u<t.length;u++){var i=t[u];E(i)&&o.push(i.slice(r))}n(null,o)},n.getLength=function(n){n(null,y(e).filter(E).length)},n.clear=function(n){y(e).filter(E).forEach(e.removeItem,e),n(null)},n.close=function(){delete h.ls,delete h.auto}};w.createKey=function(e){return l.namespace+e};var E=w.isKeeperKey=function(e){return 0==e.indexOf(l.namespace)};w.create=function(){var n=e.localStorage;return n?new w(n):null}}(self,"undefined"!=typeof exports&&exports);
//# sourceMappingURL=kv-keeper.ls.map