// KV-Keeper.js by andre487, see https://clck.ru/9cB92
!function(p,v){"use strict";function m(){e.dbVersion=1,e.dbName="kv-keeper-items",e.storeName="items",e.defaultType=f,e.namespace=d()}function d(){return e.dbName+":"+e.storeName+":"}function g(e){if(-1==[c,o,f].indexOf(e))throw new Error(a+"Invalid type "+e)}function l(e){return function(n,o){if(n)for(var r=0;r<t.length;r++)t[r](n);return e(n,o)}}function I(e){switch(e){case f:return h();case o:return r(o,DB.create());case c:return r(c,n.create())}return null}function r(e,n){return{type:e,instance:n}}function h(){var e=i.db;return e?r(o,e):(e="undefined"!=typeof DB&&DB.create())?r(o,e):(e=i.ls,e?r(c,e):"undefined"!=typeof n?r(o,n.create()):void 0)}var e,E=["setItem","getItem","removeItem","getKeys","getLength","clear"],y=["dbName","storeName","defaultType"],o="db",c="ls",f="auto",a="[kv-keeper] ",u=Object.keys,i={},t=[];v?e=v:p.KvKeeper=e={},m(),e.addErrorListener=function(e){if("function"!=typeof e)throw new Error("Listener must be a function");t.push(e)},e.removeErrorListener=function(n){var e=t.indexOf(n);e>-1&&(t=t.splice(e,1))},e.getErrorListeners=function(){return t},e.removeAllErrorListeners=function(){t=[]},e.configure=function(n){if(e.__configured)throw new Error(a+"Configuration can be set only once");e.__configured=!0,"defaultType"in n&&g(n.defaultType),u(n).forEach(function(t){if(!(y.indexOf(t)>-1))throw m(),new Error(a+t+" is not configurable");e[t]=n[t]}),e.namespace=d()},e.getStorage=function(n,t){"function"==typeof n&&(t=n,n=null),t=l(t),n=n||e.defaultType,g(n);var r=e._getInstance(n);if(r)r.init(t);else{var o=n==f?"No supported stores":'No "'+n+'" store support';t(new Error(a+o))}},e._getInstance=function(n){var e=i[n];if(!e){var t=I(n);e=i[t.type]=t.instance}return e},E.forEach(function(n){e[n]=function(){var t=arguments;e.getStorage(function(e,r){if(e){var o=t[t.length-1];return o(e)}r[n].apply(r,t)})}});var n=e.StorageLS=function(t){var e=this;e.init=function(n){n(null,e)},e.setItem=function(r,o,e){e=l(e);try{t.setItem(n.createKey(r),o),e(null)}catch(n){e(n)}},e.getItem=function(e,r){r(null,t.getItem(n.createKey(e)))},e.removeItem=function(e,r){t.removeItem(n.createKey(e)),r(null)},e.getKeys=function(e){var n=u(t).filter(s);e(null,n)},e.getLength=function(e){e(null,u(t).filter(s).length)},e.clear=function(e){u(t).filter(s).forEach(t.removeItem,t),e(null)},e.close=function(){i.ls=null}};n.createKey=function(n){return e.namespace+n};var s=n.isKeeperKey=function(n){return 0==n.indexOf(e.namespace)};n.create=function(){var e=p.localStorage;return e?new n(e):null}}(self,"undefined"!=typeof exports&&exports);
//# sourceMappingURL=kv-keeper.ls.map