// KV-Keeper.js by andre487, see https://clck.ru/9cB92
!function(e){"use strict";function n(){}function t(){h.dbVersion=1,h.dbName="kv-keeper-items",h.storeName="items",h.defaultType=p,h.namespace=r()}function r(){return h.dbName+":"+h.storeName+":"}function o(e){if([m,s,p].indexOf(e)==-1)throw new Error(d+"Invalid type "+e)}function u(e){var t=e||n;return function(e,n){if(e)for(var r=0;r<y.length;r++)y[r](e);return t(e,n)}}function i(e){switch(e){case p:return a();case s:return c(s,DB.create());case m:return c(m,w.create())}return null}function c(e,n){return{type:e,instance:n}}function a(){var e=v.db;return e?c(s,e):(e="undefined"!=typeof DB&&DB.create())?c(s,e):(e=v.ls,e?c(m,e):"undefined"!=typeof w?c(m,w.create()):void 0)}var f=["setItem","getItem","hasItem","removeItem","getKeys","getLength","clear"],l=["dbName","storeName","defaultType"],s="db",m="ls",p="auto",d="[kv-keeper] ",g=Object.keys,v={},y=[],h={},I=!0;"object"==typeof exports&&(exports=h,I=!1),e.modules&&modules.define&&modules.require&&(modules.define("kv-keeper",function(e){e(h)}),I=!1),I&&(e.KvKeeper=h),t(),h.preconnect=function(){h.getStorage(n)},h.addErrorListener=function(e){if("function"!=typeof e)throw new Error("Listener must be a function");y.push(e)},h.removeErrorListener=function(e){var n=y.indexOf(e);n>-1&&y.splice(n,1)},h.getErrorListeners=function(){return y},h.removeAllErrorListeners=function(){y=[]},h.configure=function(e){if(h.__configured)throw new Error(d+"Configuration can be set only once");h.__configured=!0,"defaultType"in e&&o(e.defaultType);for(var n in e)if(e.hasOwnProperty(n)){if(!(l.indexOf(n)>-1))throw t(),new Error(d+n+" is not configurable");h[n]=e[n]}h.namespace=r()},h.getStorage=function(e,n){var t=e,r=n;"function"==typeof t&&(r=e,t=null),r=u(r),t=t||h.defaultType,o(t),h._getInstance(t,r)},h._getInstance=function(e,n){var t=v[e];if(t)return n(null,t);var r=d+(e==p?"No supported storages":'No "'+e+'" storage support');if(null===t)return n(new Error(r));var o=i(e);return o&&o.instance?(t=v[e]=o.instance,void t.init(n)):n(new Error(r))},f.forEach(function(e){h[e]=function(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);h.getStorage(function(r,o){if(r){var u=t.filter(function(e){return"function"==typeof e})[0]||n;return u(r)}o[e].apply(o,t)})}});var w=h.StorageLS=function(e){var t=this;t.init=function(e){e(null,t)},t.setItem=function(n,t,r){var o=u(r);try{e.setItem(w.createKey(n),t),o(null)}catch(e){o(e)}},t.getItem=function(n,t){t(null,e.getItem(w.createKey(n)))},t.hasItem=function(n,t){t(null,null!==e.getItem(w.createKey(n)))},t.removeItem=function(t,r){var o=r||n;e.removeItem(w.createKey(t)),o(null)},t.getKeys=function(n){for(var t=g(e),r=h.namespace.length,o=[],u=0;u<t.length;u++){var i=t[u];E(i)&&o.push(i.slice(r))}n(null,o)},t.getLength=function(n){n(null,g(e).filter(E).length)},t.clear=function(n){g(e).filter(E).forEach(e.removeItem,e),n(null)},t.close=function(){delete v.ls,delete v.auto}};w.createKey=function(e){return h.namespace+e};var E=w.isKeeperKey=function(e){return 0==e.indexOf(h.namespace)};w.create=function(){var n;try{n=e.localStorage}catch(e){}return n?new w(n):null}}(self);
//# sourceMappingURL=kv-keeper.ls.map